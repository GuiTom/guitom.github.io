<!-- <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd"> -->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
 	<meta name="description" content="编程">
 	<meta name="keywords" content="IT教程 ">
    <meta name="viewport" content="width=device-width, initial-scale=1 , user-scalable=no">
    
<!-- <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/> -->
<title>AsyncDisplayKit-iOS开发(高级篇)</title>


    

	<link rel="stylesheet" href="/lib/css/bootstrap.min.css">
    <link rel="stylesheet" href="/lib/css/bootstrap-maizi.css">
    <link rel="stylesheet" href="/lib/css/animate.css">
    <!-- <script  src="https://libs.baidu.com/jquery/1.10.2/jquery.min.js"></script> -->
    <script src="/lib/js/jquery.min.js"></script>
    <script src="/lib/js/bootstrap.min.js"></script>
    
    <script src="/lib/js/jquery.singlePageNav.min.js"></script>
    <script src="/lib/js/jquery.cookie.js"></script>
    
	
<script src="/js/article.js"></script>
<!--百度统计-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?a684a10bc59d54f03381c502765556bb";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<script type="text/javascript">
    // var siteHome = './';
    var staticHTMLUri = '/';
</script>


</head>
<body>
	
		  
		   <div style="height:50px;margin-bottom: 0px;"><nav class="navbar navbar-default navbar-fixed-top" id="topNav">		   <div class="container"> 
		    <!--导航--> 
		    <!--小屏幕导航按钮和logo--> 
		    <div class="navbar-header"> 
		     <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> 
		     <a href="https://guitom.github.io/" class="navbar-brand" style="color: #1196EE;"><span>趣通小教程</span>&nbsp;<span>guitom.github.io</span></a> 
		    </div> 
		    <!--小屏幕导航按钮和logo--> 
		    <div class="navbar-collapse collapse"> 
		     <div class="profile navbar-right"> 
			      <!-- 	<ul class="nav navbar-nav"> 
			       		<li><a href="#home" data-toggle="modal" id="collector">收藏夹</a></li>
			       		<li><a href="#home" data-toggle="modal" id="homePageloginBtn">登录</a></li> 
			      		<li><a href="#home" data-toggle="modal" id="loginStatus"></a></li> 
			      	</ul>  -->
		      		
		     </div> 
		     <ul class="nav navbar-nav navbar-center"> 
		      <li> 
		       <!--搜索框--> 
		       <div class="input-group hidden" id="searchBox" style="max-width:300px;height:30px;margin-top:10px;"> 
		        <input type="text" class="form-control input-md" placeholder="输入关键词" onkeydown="onKeyDown(event)" /> 
		        <span class="input-group-addon btn btn-primary">搜索</span> 
		       </div> 
		       <!--搜索框--></li> 
	
		     </ul> 
		    </div> 
		   </div> </nav></div>
		  
	
	
<style type="text/css">
    .panel-heading{
        padding-top: 5px;
        padding-right: 5px;
    }
    .panel-body {
        padding: 10px;
    }
    .panel-body div {
        padding-left: 20px;
    }

    .menu-container{
        border-width: 2px;
        border-radius: 5px;
        border-color: green;
        border:5px solid #f6f4f0;
    
    }
    .menu-container div{
        padding-right: 10px;
        padding-left: 10px;
        line-height: 30px;
    }
    .chapter{
        background-color: #f0f0f0;
        font-weight: bold;

    }
    .course{
        background-color: #e2e2e2;
        text-indent: 0em;
    }
    .normal{
        color: black;
    }
    .selected{
        background-color: #1196EE;
        color: white;
    }
    .block{
        /*border: thick solid #e1e1e1;*/
        
    }
    .preview{
        display: none;
    }
    .item{
        border-bottom-style:solid;
        border-width: 1px;
        border-color: #f1f1f1;
        cursor:pointer;
    }
    .content{
        border-radius: 5px;
    }
    a:hover{
        text-decoration: none;
    }
    body{
        background-color: #dfdfdf;
    }
    td {
        border: 1px solid #ddd
    }
</style>
<div class="container">
<!-- <div class="row">
    <div class="col-sm-12" style="background-color: white;border-radius:8px;border-style: solid;border-color:#dfdfdf ">
        
    </div>
</div> -->
<div class="row">
    <div class="col-sm-12 text-center" style="padding-top: 20px;">
        <strong>AsyncDisplayKit-iOS开发(高级篇)</strong>
    </div>
</div>
<div class="row" style="margin-top:5px;">
    <div class="col-sm-2" style="overflow-y: auto;max-height:100%;overflow-x: hidden;">
                <div class="menu-container">
                    <div id="06024caB" class="item chapter normal selected">Runtime</div>

<div id="5b514C5a" class="item course normal">方法交换</div>
<div id="67C92673" class="item course normal">动态添加方法</div>
<div id="8A546ac3" class="item course normal">关联对象</div><div id="39c93aA5" class="item course normal">KVO的实现</div><div id="93C8046a" class="item chapter normal">内存管理</div><div id="c1944c7C" class="item course normal">TaggedPointer</div><div id="3ABca2ab" class="item course normal">小测验</div><div id="AAB71A4b" class="item course normal">NONPOINTER_ISA</div><div id="3Ac50559" class="item course normal">散列表 </div><div id="8BA7CC22" class="item course normal">Copy和mutableCopy</div><div id="6B5C7c25" class="item course normal">对象的销毁dealloc</div><div id="97cc9C51" class="item course normal">常用lldb命令</div>


































<div id="9ccab66A" class="item chapter normal">RunLoop</div><div id="3C6a652B" class="item course normal">NSTimer应用</div><div id="07A53392" class="item course normal">线程保活</div><div id="4a6ac2bb" class="item course normal">UIImage空闲时渲染</div><div id="A5bCb944" class="item course normal">线程间通信(NSPort)</div><div id="471ab021" class="item course normal">卡顿检测</div><div id="30A6AA7A" class="item course normal">自动释放池</div><div id="2A662A6A" class="item chapter normal">UI视图</div><div id="4b1Aa8ba" class="item course normal">UI绘制原理</div><div id="C1AB418B" class="item course normal">UI事件传递机制</div><div id="3C991812" class="item course normal">事件传递相关练习题</div><div id="12B75430" class="item course normal">事件响应链</div><div id="4Cc0CC83" class="item course normal">相关面试题</div><div id="0CbB19c9" class="item chapter normal">多线程</div><div id="217b960B" class="item course normal">pthread</div><div id="53870C1a" class="item course normal">NSThread</div><div id="3a61B9a4" class="item course normal">GCD基础API(1)</div><div id="88bB0879" class="item course normal">GCD基础API(2)</div><div id="cc300B3b" class="item course normal">GCD经典面试题</div><div id="29108B1C" class="item course normal">GCD高级 API</div><div id="8BC7b1B3" class="item course normal">NSOpreation</div><div id="4635Bb8A" class="item course normal">多线程面试题</div><div id="C5C1C965" class="item course normal">锁</div><div id="28c98C11" class="item course normal">锁相关面试题</div><div id="B529829C" class="item course normal">信号量</div><div id="8a900c58" class="item chapter normal">OC语言</div><div id="A01181B1" class="item course normal">属性关键字</div><div id="a24C78b3" class="item course normal">内存管理</div><div id="1472b4c0" class="item course normal">KVO</div><div id="BC924416" class="item chapter normal">block及其本质</div><div id="61a4a56A" class="item course normal">block按存储区分类</div><div id="C3803054" class="item course normal">变量截取</div><div id="Cc14A93c" class="item course normal">相关面试题</div><div id="a6a97753" class="item chapter normal">第三方库</div><div id="14ab67AB" class="item course normal">AFNetWorking</div><div id="6A235a3B" class="item course normal">SDWebImageView</div><div id="2c7C0120" class="item course normal">ReactiveCocoa</div><div id="a5488b6B" class="item course normal">AsyncDisplayKit</div><div id="B5b3B053" class="item chapter normal">性能优化</div><div id="0A415471" class="item course normal">UI卡顿优化</div><div id="C094BcBc" class="item course normal">离屏渲染优化</div><div id="b2b21885" class="item course normal">卡顿检测</div><div id="56529C54" class="item course normal">电量优化</div><div id="AcaAbB32" class="item course normal">APP冷启动优化</div>
                </div>
                <div style="float:left;margin-top: 30px;width: 1px;height: 100%;background: darkgray;"></div>
        </div>
    <div class="col-sm-10 content" style="overflow-y: auto;height: 100%;background-color: white;padding-top:20px;">
         <div class="row">
             <div class="col-sm-12">
                 <p><img src="/upload/image/2019119/084202517700.png" title="屏幕快照 2019-11-06 19.57.31.png" alt="屏幕快照 2019-11-06 19.57.31.png" width="734" height="377" style="width: 734px; height: 377px;"/></p><h2 class="none" style="box-sizing: border-box; margin: 30px 0px 0px; padding: 0px 0px 10px; border: 0px; outline: 0px; font-size: 26px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1em; font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">AsyncDisplayKit</strong></h2><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">AsyncDisplayKit 是 Facebook 开源的一个用于保持 iOS 界面流畅的库，我从中学到了很多东西，所以下面我会花较大的篇幅来对其进行介绍和分析。</p><p style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; color: rgb(32, 154, 252);" name="41"></a></p><h3 class="none" style="box-sizing: border-box; margin: 0px; padding: 0px 0px 10px; border: 0px; outline: 0px; font-size: 22px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1em; font-weight: 400; font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">ASDK 的由来</strong></h3><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/scott_goodson.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41900" src="/upload/image/20191114/170502145510.png" alt="scott_goodson" width="150" height="150" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">ASDK 的作者是 Scott Goodson (<a href="https://www.linkedin.com/in/iosengineer" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">Linkedin</a>)，<br style="box-sizing: border-box;"/>他曾经在苹果工作，负责 iOS 的一些内置应用的开发，比如股票、计算器、地图、钟表、设置、Safari 等，当然他也参与了 UIKit framework 的开发。后来他加入 Facebook 后，负责 Paper 的开发，创建并开源了 AsyncDisplayKit。目前他在 Pinterest 和 Instagram 负责 iOS 开发和用户体验的提升等工作。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/asdk_history.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41901" src="/upload/image/20191114/170504738204.png" alt="asdk_history" width="484" height="160" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">ASDK 自 2014 年 6 月开源，10 月发布 1.0 版。目前 ASDK 即将要发布 2.0 版。<br style="box-sizing: border-box;"/>V2.0 增加了更多布局相关的代码，ComponentKit 团队为此贡献很多。<br style="box-sizing: border-box;"/>现在 Github 的 master 分支上的版本是 V1.9.1，已经包含了 V2.0 的全部内容。</p><p style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; color: rgb(32, 154, 252);" name="42"></a></p><h3 class="none" style="box-sizing: border-box; margin: 0px; padding: 0px 0px 10px; border: 0px; outline: 0px; font-size: 22px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1em; font-weight: 400; font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">ASDK 的资料</strong></h3><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">想要了解 ASDK 的原理和细节，最好从下面几个视频开始：<br style="box-sizing: border-box;"/>2014.10.15&nbsp;<a href="https://www.youtube.com/watch?v=-IPMNWqA638" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">NSLondon – Scott Goodson – Behind AsyncDisplayKit</a><br style="box-sizing: border-box;"/>2015.03.02&nbsp;<a href="https://www.youtube.com/watch?v=ZPL4Nse76oY" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">MCE 2015 – Scott Goodson – Effortless Responsiveness with AsyncDisplayKit</a><br style="box-sizing: border-box;"/>2015.10.25&nbsp;<a href="https://www.youtube.com/watch?v=RY_X7l1g79Q" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">AsyncDisplayKit 2.0: Intelligent User Interfaces – NSSpain 2015</a><br style="box-sizing: border-box;"/>前两个视频内容大同小异，都是介绍 ASDK 的基本原理，附带介绍 POP 等其他项目。<br style="box-sizing: border-box;"/>后一个视频增加了 ASDK 2.0 的新特性的介绍。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">除此之外，还可以到 Github Issues 里看一下 ASDK 相关的讨论，下面是几个比较重要的内容：<br style="box-sizing: border-box;"/><a href="https://github.com/facebook/AsyncDisplayKit/issues/42" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">关于 Runloop Dispatch</a><br style="box-sizing: border-box;"/><a href="https://github.com/facebook/AsyncDisplayKit/issues/70" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">关于 ComponentKit 和 ASDK 的区别</a><br style="box-sizing: border-box;"/><a href="https://github.com/facebook/AsyncDisplayKit/issues/132" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">为什么不支持 Storyboard 和 Autolayout</a><br style="box-sizing: border-box;"/><a href="https://github.com/facebook/AsyncDisplayKit/issues/204" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">如何评测界面的流畅度</a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">之后，还可以到 Google Groups 来查看和讨论更多内容：<br style="box-sizing: border-box;"/><a href="https://groups.google.com/forum/#!forum/asyncdisplaykit" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">https://groups.google.com/forum/#!forum/asyncdisplaykit</a></p><p style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; color: rgb(32, 154, 252);" name="43"></a></p><h3 class="none" style="box-sizing: border-box; margin: 0px; padding: 0px 0px 10px; border: 0px; outline: 0px; font-size: 22px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1em; font-weight: 400; font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">ASDK 的基本原理</strong></h3><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/asdk_design.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41902" src="/upload/image/20191114/170505835841.png" alt="asdk_design" width="496" height="255" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">ASDK 认为，阻塞主线程的任务，主要分为上面这三大类。文本和布局的计算、渲染、解码、绘制都可以通过各种方式异步执行，但 UIKit 和 Core Animation 相关操作必需在主线程进行。ASDK 的目标，就是尽量把这些任务从主线程挪走，而挪不走的，就尽量优化性能。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">为了达成这一目标，ASDK 尝试对 UIKit 组件进行封装：</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/asdk_layer_backed_view.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41903" src="/upload/image/20191114/170506778673.png" alt="asdk_layer_backed_view" width="363" height="162" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">这是常见的 UIView 和 CALayer 的关系：View 持有 Layer 用于显示，View 中大部分显示属性实际是从 Layer 映射而来；Layer 的 delegate 在这里是 View，当其属性改变、动画产生时，View 能够得到通知。UIView 和 CALayer 不是线程安全的，并且只能在主线程创建、访问和销毁。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/asdk_view_backed_node.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41904" src="/upload/image/20191114/170508354414.png" alt="asdk_view_backed_node" width="605" height="165" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">ASDK 为此创建了 ASDisplayNode 类，包装了常见的视图属性（比如 frame/bounds/alpha/transform/backgroundColor/superNode/subNodes 等），然后它用 UIView-&gt;CALayer 相同的方式，实现了 ASNode-&gt;UIView 这样一个关系。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/asdk_layer_backed_node.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41905" src="/upload/image/20191114/170509143239.png" alt="asdk_layer_backed_node" width="605" height="167" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">当不需要响应触摸事件时，ASDisplayNode 可以被设置为 layer backed，即 ASDisplayNode 充当了原来 UIView 的功能，节省了更多资源。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">与 UIView 和 CALayer 不同，ASDisplayNode 是线程安全的，它可以在后台线程创建和修改。Node 刚创建时，并不会在内部新建 UIView 和 CALayer，直到第一次在主线程访问 view 或 layer 属性时，它才会在内部生成对应的对象。当它的属性（比如frame/transform）改变后，它并不会立刻同步到其持有的 view 或 layer 去，而是把被改变的属性保存到内部的一个中间变量，稍后在需要时，再通过某个机制一次性设置到内部的 view 或 layer。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">通过模拟和封装 UIView/CALayer，开发者可以把代码中的 UIView 替换为 ASNode，很大的降低了开发和学习成本，同时能获得 ASDK 底层大量的性能优化。为了方便使用， ASDK 把大量常用控件都封装成了 ASNode 的子类，比如 Button、Control、Cell、Image、ImageView、Text、TableView、CollectionView 等。利用这些控件，开发者可以尽量避免直接使用 UIKit 相关控件，以获得更完整的性能提升。</p><p style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; color: rgb(32, 154, 252);" name="44"></a></p><h3 class="none" style="box-sizing: border-box; margin: 0px; padding: 0px 0px 10px; border: 0px; outline: 0px; font-size: 22px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1em; font-weight: 400; font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">ASDK 的图层预合成</strong></h3><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/asdk_comoose_1.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41906" src="/upload/image/20191114/170510694617.png" alt="asdk_comoose_1" width="200" height="200" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a>&nbsp;<a href="https://blog.ibireme.com/wp-content/uploads/2015/11/asdk_compose_2.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41907" src="/upload/image/20191114/170513665699.png" alt="asdk_compose_2" width="200" height="200" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">有时一个 layer 会包含很多 sub-layer，而这些 sub-layer 并不需要响应触摸事件，也不需要进行动画和位置调整。ASDK 为此实现了一个被称为 pre-composing 的技术，可以把这些 sub-layer 合成渲染为一张图片。开发时，ASNode 已经替代了 UIView 和 CALayer；直接使用各种 Node 控件并设置为 layer backed 后，ASNode 甚至可以通过预合成来避免创建内部的 UIView 和 CALayer。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">通过这种方式，把一个大的层级，通过一个大的绘制方法绘制到一张图上，性能会获得很大提升。CPU 避免了创建 UIKit 对象的资源消耗，GPU 避免了多张 texture 合成和渲染的消耗，更少的 bitmap 也意味着更少的内存占用。</p><p style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; color: rgb(32, 154, 252);" name="45"></a></p><h3 class="none" style="box-sizing: border-box; margin: 0px; padding: 0px 0px 10px; border: 0px; outline: 0px; font-size: 22px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1em; font-weight: 400; font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">ASDK 异步并发操作</strong></h3><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/asdk_a9_chip.jpg" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41908" src="/upload/image/20191114/170516903192.png" alt="asdk_a9_chip" width="313" height="176" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">自 iPhone 4S 起，iDevice 已经都是双核 CPU 了，现在的 iPad 甚至已经更新到 3 核了。充分利用多核的优势、并发执行任务对保持界面流畅有很大作用。ASDK 把布局计算、文本排版、图片/文本/图形渲染等操作都封装成较小的任务，并利用 GCD 异步并发执行。如果开发者使用了 ASNode 相关的控件，那么这些并发操作会自动在后台进行，无需进行过多配置。</p><p style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; color: rgb(32, 154, 252);" name="46"></a></p><h3 class="none" style="box-sizing: border-box; margin: 0px; padding: 0px 0px 10px; border: 0px; outline: 0px; font-size: 22px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1em; font-weight: 400; font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">Runloop 任务分发</strong></h3><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">Runloop work distribution 是 ASDK 比较核心的一个技术，ASDK 的介绍视频和文档中都没有详细展开介绍，所以这里我会多做一些分析。如果你对 Runloop 还不太了解，可以看一下我之前的文章<a href="https://blog.ibireme.com/2015/05/18/runloop/" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">&nbsp;深入理解RunLoop</a>，里面对 ASDK 也有所提及。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><a href="https://blog.ibireme.com/wp-content/uploads/2015/11/ios_vsync_runloop.png" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);"><img class="alignnone wp-image-41909" src="/upload/image/20191114/170520831519.png" alt="ios_vsync_runloop" width="564" height="234" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: bottom; background: transparent; max-width: 100%; height: auto;"/></a></p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">iOS 的显示系统是由 VSync 信号驱动的，VSync 信号由硬件时钟生成，每秒钟发出 60 次（这个值取决设备硬件，比如 iPhone 真机上通常是 59.97）。iOS 图形服务接收到 VSync 信号后，会通过 IPC 通知到 App 内。App 的 Runloop 在启动后会注册对应的 CFRunLoopSource 通过 mach_port 接收传过来的时钟信号通知，随后 Source 的回调会驱动整个 App 的动画与显示。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">Core Animation 在 RunLoop 中注册了一个 Observer，监听了 BeforeWaiting 和 Exit 事件。这个 Observer 的优先级是 2000000，低于常见的其他 Observer。当一个触摸事件到来时，RunLoop 被唤醒，App 中的代码会执行一些操作，比如创建和调整视图层级、设置 UIView 的 frame、修改 CALayer 的透明度、为视图添加一个动画；这些操作最终都会被 CALayer 捕获，并通过 CATransaction 提交到一个中间状态去（CATransaction 的文档略有提到这些内容，但并不完整）。当上面所有操作结束后，RunLoop 即将进入休眠（或者退出）时，关注该事件的 Observer 都会得到通知。这时 CA 注册的那个 Observer 就会在回调中，把所有的中间状态合并提交到 GPU 去显示；如果此处有动画，CA 会通过 DisplayLink 等机制多次触发相关流程。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">ASDK 在此处模拟了 Core Animation 的这个机制：所有针对 ASNode 的修改和提交，总有些任务是必需放入主线程执行的。当出现这种任务时，ASNode 会把任务用 ASAsyncTransaction(Group) 封装并提交到一个全局的容器去。ASDK 也在 RunLoop 中注册了一个 Observer，监视的事件和 CA 一样，但优先级比 CA 要低。当 RunLoop 进入休眠前、CA 处理完事件后，ASDK 就会执行该 loop 内提交的所有任务。具体代码见这个文件：<a href="https://github.com/facebook/AsyncDisplayKit/blob/master/AsyncDisplayKit%2FDetails%2FTransactions%2F_ASAsyncTransactionGroup.m" target="_blank" style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; text-decoration-line: none; color: rgb(32, 154, 252);">ASAsyncTransactionGroup</a>。</p><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">通过这种机制，ASDK 可以在合适的机会把异步、并发的操作同步到主线程去，并且能获得不错的性能。</p><h3 class="none" style="box-sizing: border-box; margin: 0px; padding: 0px 0px 10px; border: 0px; outline: 0px; font-size: 22px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(51, 51, 51); line-height: 1em; font-weight: 400; font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;"><strong style="box-sizing: border-box; margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent;">其他</strong></h3><p class="none" style="box-sizing: border-box; margin-top: 0.9em; margin-bottom: 0.5em; padding: 0px 0px 0.6em; border: 0px; outline: 0px; vertical-align: baseline; background: rgb(255, 255, 255); color: rgb(29, 29, 29); font-family: &quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, &quot;Hiragino Sans GB&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Source Han Sans CN&quot;, STHeiti, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun, sans-serif; white-space: normal;">ASDK 中还有封装很多高级的功能，比如滑动列表的预加载、V2.0添加的新的布局模式等。ASDK 是一个很庞大的库，它本身并不推荐你把整个 App 全部都改为 ASDK 驱动，把最需要提升交互性能的地方用 ASDK 进行优化就足够了。</p><p><a href="https://www.jianshu.com/p/58e7571d7806" target="_blank">原文链接</a>:<a href="https://www.jianshu.com/p/58e7571d7806">https://www.jianshu.com/p/58e7571d7806</a></p>
             </div>
         </div>
        <div class="row" style="background-color: #eeeeee;">
            
             <div class="col-sm-4 text-left left-arror">
                 
             </div>
       
             <div class="col-sm-4 col-sm-offset-4 text-right right-arror">
                
             </div>
        
         </div>

    </div>
</div>
<div class="row">
    <div class="col-sm-12 text-center" style="padding-top: 10px;">
        <a href="https://www.onlinegdb.com/" target="_blank"><strong><font color="black">在线编程工具</font></strong></a>
    </div>
</div>
</div>
<script type="text/javascript">
// var siteHome = './';
var tutorial_id = 'a948A25C';
var article_id = 'a5488b6B';
</script>

	
	
	
</body>